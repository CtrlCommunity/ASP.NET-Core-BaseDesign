@{
    Layout = "~/Areas/SysManage/Views/Shared/_LayoutPageBaseForm.cshtml";
}
@model SystemUser
<div class="row">
    <div class="col-lg-12">
        <form class="form-horizontal ctrl-form">
            @Html.AntiForgeryToken()
            <div class="hr-line-dashed"></div>
            <div class="form-group">
                <label class="col-sm-2 control-label">头像：</label>
                <div class="col-sm-10">
                    <img class="img-circle image-responsive" id="artimg" style="height: 70px;margin:10px;" src="@(string.IsNullOrWhiteSpace(Model.ImgUrl)?"/images/u.jpg":Model.ImgUrl)" alt="头像" />
                    <input type="file" id='File' class='form-control input-sm'>
                    <input type="text" id='ImgUrl' name='ImgUrl' value="@Model.ImgUrl" hidden="hidden">
                </div>
            </div>
            <div class="hr-line-dashed"></div>
            <div class="form-group">
                <label class="col-sm-2 control-label">角色：</label>
                <div class="col-sm-10">
                    <label class=" control-label">@ViewBag.RoleName</label>
                </div>
            </div>
            <div class="hr-line-dashed"></div>
            <div class="form-group">
                <label class="col-sm-2 control-label">真实姓名：</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control input-sm" value="@Model.Name" name="Name" data-parsley-required="真实姓名">
                </div>
            </div>

            <div class="hr-line-dashed"></div>
            <div class="form-group">
                <label class="col-sm-2 control-label">登录名：</label>
                <div class="col-sm-10">
                    <label class=" control-label">@Model.Code</label>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                    <input type="submit" value="保 存" id="btnForm" class="btn btn-primary" />
                </div>
            </div>

        </form>
    </div>
    </div>
    <script>
        $("#File").fileimage("/sysManage/UserControl/FileSave", $("#ImgUrl"), $("#artimg"));
        $(function () {
            var $form = $('form');
            var instance = $form.parsley();
            $("#btnForm").bind("click", function () {
                $("#btnForm").attr({ "disabled": "disabled" });
                if (instance.isValid()) {
                    $post("/SysManage/Account/UserInfoUpdateSave", $form.serialize()).then(function (data) {
                        $.Alert(data, function () {
                            if (data.resultSign == 0) {
                                window.location.reload();
                            }
                        });
                    })
                    $("#btnForm").removeAttr("disabled");
                    return false;
                } else {
                    $("#btnForm").removeAttr("disabled");
                }
            })
        })
    </script>
